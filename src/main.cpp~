#include <iostream>
#include <opencv2/opencv.hpp>
#include <zbar.h>

using namespace cv;
using namespace std;
using namespace zbar;

int main() {
  ImageScanner scanner;
  scanner.set_config(ZBAR_NONE, ZBAR_CFG_ENABLE, 1);
  Mat image = imread("/home/jhermosilla/Documents/Proyects/zbar_test.jpg");

  Mat gray;
  cvtColor(image, gray, COLOR_RGB2GRAY);
      
  Image imageZbar(gray.cols, gray.rows, "Y800", gray.data, gray.cols * gray.rows);
  int n=scanner.scan(imageZbar);

  Image::SymbolIterator symbol = imageZbar.symbol_begin();
  if (imageZbar.symbol_begin() == imageZbar.symbol_end()) {
    cout << "Errorï¼" << endl;
  }
  for (; symbol != imageZbar.symbol_end(); ++symbol) {
    cout << symbol->get_data() << endl;
  }

  return 0;
}
